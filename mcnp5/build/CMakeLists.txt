# MCNP CMAKE FILE
enable_language(Fortran)
PROJECT(MCNP5)

INCLUDE_DIRECTORIES("${CMAKE_CURRENT_SOURCE_DIR}/../tally/")

set(INSTALL_LIB_DIR lib CACHE PATH "Installation Directory for Libraries")
set(INSTALL_INCLUDE_DIR include CACHE PATH "Installation directory for header")
set(INSTALL_BIN_DIR bin CACHE PATH "Installation directory for executables")

# modifed from http://www.cmake.org/pipermail/cmake/2010-November/041034.html
MACRO (DATETIME RESULT)
  EXECUTE_PROCESS(COMMAND "date" "+%d/%m/%Y" OUTPUT_VARIABLE ${RESULT})
  STRING(REGEX REPLACE "(..)/(..)/..(..).*" "\"\\2/\\1/\\3\"" ${RESULT} ${${RESULT}})
ENDMACRO (DATETIME)

MESSAGE(STATUS "Building MCNP")
SET(MCNP_SRC ${CMAKE_CURRENT_SOURCE_DIR})

# If mpi then need the dotcomm libs
IF(MPI_BUILD)
  FIND_package(MPI)
  include_directories(${MPI_INCLUDE_PATH})
  # keep as seperate in case we need seperate Dotcomm
  SET(DOTCOMM_SRC ${MCNP_SRC}/Source/dotcomm)
  INCLUDE_DIRECTORIES(${DOTCOMM_SRC}/include/)
  INCLUDE_DIRECTORIES(${DOTCOMM_SRC}/src/internals/mpi/)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_abort.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_allreduce.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_barrier.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_barrier_idle.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_bcast.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_check_process.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_enroll.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_get_context.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_get_numhosts.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_get_numpes.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_get_penum.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_init.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_init_send.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_msg_info.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_pack.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_pbcast.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_precv.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_probe.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_psend.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_recv.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_reduce.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_send.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_set_context.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_terminate.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommi_unpack.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommpi_binary_op.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommpi_convert.c)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/internals/mpi/dotcommpi_sizeof.c)
# dotcomm f90 files
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_abort.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_allreduce.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_barrier.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_barrier_idle.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_bcast.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_check_process.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_const_mod.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_enroll.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_get_context.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_get_numhosts.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_get_numpes.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_get_penum.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_init.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_init_send.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_mod.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_msg_info.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_pack.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_pbcast.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_precv.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_probe.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_psend.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_recv.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_reduce.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_send.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_set_context.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_terminate.F90)
  LIST(APPEND DOTCOMM_SRC_FILES ${DOTCOMM_SRC}/src/dotcomm_unpack.F90)
  LIST(APPEND MCNP_SRC_FILES ${DOTCOMM_SRC_FILES})
ENDIF()

# Standard MCNP source
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acecas.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acecol.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acecos.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acecs6.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acedel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acefcn.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acefpt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acegam.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acenu.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acenus.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/aceprt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acetbl.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/acetot.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/action.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/addtfc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/amatrx.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/angl.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/annihilation_gammas.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/arbobv.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/avrclc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/avrnrm.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/avrout.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/avrwgi.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/avrwwg.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/avrxyz.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/axis.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/backup.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/bankit.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/begone.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/binlin.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/binval.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/brang.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/brem.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/brems.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/broadn.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/calcps.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/calcva.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/celnbr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/celpar.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/celsrf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/chekcs.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/chekit.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/chektr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/chkcel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/chksrc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/chqcel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/colidk.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/colidn.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/colidp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/colinp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/collpn.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/confid.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/covar.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/cprinp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/crit1_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/crit2_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/crspro.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/crtcze.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dbmin.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dddet.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dddiag.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dddlev.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/den1.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/den2.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dmmp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dopplerp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dosef.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dotrcl.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dunlev.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dxdiag.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dxtran_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dynamic_arrays.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/echkcl.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/electr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/electron_history.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/emaker.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/entropy_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ephcom.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/eqpbbn.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/erf2.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ergimp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/erprnt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/errprn.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/escat.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/etsplt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/eventp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/excitation_energies.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/exemes.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/exmg.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/expire.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/expirx.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/expung.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/extran.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/fastdr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ffetch.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/findel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/findlv.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/finpht.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/fixcom.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/flaug_elec.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/flaug_phot.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/fmesh_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/fmesh_plot_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/forcol.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/fshort.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/getexm.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/getidt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/getpar.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/getxs.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/getxst.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ginst.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/gkssim.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/gmgww.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/gxsub.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/hpsort.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/hstory.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/igeom.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/imcn.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/inpert.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/inter.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/intsec.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ipbc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/isheet.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/isos.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/isotopic_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/isourc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/issrc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/itally.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/italpr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/items.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/iwtwnd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ixsdir.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/jbin.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/jdecod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/jsourc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/kadjoint_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/kdarg.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/kdata.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/kinetics_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/klein.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/knock.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/kxray.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/latcon.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/levcel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/levchk.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/lgeval.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/likebt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/lx5_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mapmaz.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/matmpy.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mbody.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mbodyo.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mbodyp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mbodyr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mbodys.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_data.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_debug.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_global.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_input.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_iofiles.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_landau.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_params.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_plot.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcnp_random.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcplot_module.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mcrun.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mctalw.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/messages.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mgacol.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mgcoln.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mgcolp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mgimps.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/mgxspt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/midpnt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/movlat.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/msgcon.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/msgtsk.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/namchg.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/namrsd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/newcd1.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/newcel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/newcrd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/nextit.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/norma.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/normh.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/nsf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/nsourc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/nxtit1.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/nxtsym.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/oldcd1.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/oldcrd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/output.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pareto.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pass1.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pathmz.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pblcom.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pconst.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pertc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pertub.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/photot.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/photp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/phtvr_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pieces.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/plotg.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltadd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltdat.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltdxt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltloc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltmsh.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltscr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltsrf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pltsup.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pnctot.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/polhed.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prhpdf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prinv.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prlost.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prsdft.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prsdst.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prssrj.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prstat.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/prtfcc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/psurf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ptfc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ptost.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ptrak.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/pttyin.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/putlbl.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/putnq.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/qnc7.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/qpol.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/qttyin.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/quad.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/quart.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ra1_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ra2_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/racom.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/rdprob.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/read_line.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/reflec.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/refpbc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/regula.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/rhoden.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/rmc_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ronge.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/rotas.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/rslmaz.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/runtpq.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/runtpr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/runtpw.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sabcol.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/savpar.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/scat.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/scatt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/screen.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/secnd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/setcel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/setdas.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sfiles.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/shade.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/simint.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/simplx.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sing.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/smmp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/smpsrc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sourcb.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sourck.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/spec.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/spol.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sprob.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sqqint.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/srcdx.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/srcsrf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sread.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ssmsrc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/startp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sttop.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/stuff.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sufwrt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sumary.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/surfac.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/sursrc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tallmg.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/talloc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tallyd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tally.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tallyh.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tallyp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tallyq.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tallyx.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/talph.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/talshf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tarea.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tbl130.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tbl140.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tekdvr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tgtvel.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/torus.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tpefil.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/track.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/transm.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/trfmat.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/trfsrf.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/trnspt.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/tskcom.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ttbr.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ttyint.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ufiles.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/unimaz.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/unique.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/uplev.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/uplpos.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/uran_mod.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ures.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/utask.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/varcom.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/viewz.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/voidcd.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/volume.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/vtask.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/wgtul.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/wrwssa.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/wtcalc.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/wtmult.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/wtwndo.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/wwfile.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/wwval.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/xact.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/xsec.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/xsgen.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/ypbssp.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/zaid.F90)

LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/source.F90)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/source_sampling.cpp)
LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/measure.cpp)


# cpp files go here
# LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/plasma_source.cpp)

set_source_files_properties(mcnp_params.F90 PROPERTIES COMPILE_FLAGS -cpp)

# if we have dag then add this file 
IF(BUILD_MCNP5)
 LIST(APPEND MCNP_SRC_FILES ${MCNP_SRC}/Source/src/dagmc_mod.F90)
 LIST(APPEND MCNP_SRC_FILES ${CMAKE_CURRENT_SOURCE_DIR}/meshtal_funcs.cpp)
ENDIF()

# if openmp wanted
IF(OPENMP_BUILD)
 find_package(OpenMP)
 if (OPENMP_FOUND)
     set (CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
     set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${OpenMP_CXX_FLAGS}")
     set (CMAKE_Fortran_FLAGS "${CMAKE_Fortran_Flags} ${OpenMP_Fortran_FLAGS}")
 endif(OPENMP_FOUND)
ENDIF(OPENMP_BUILD)

add_definitions(-DVERS="5")
# get the date
DATETIME(DATE)
# set the date
add_definitions(-DLODDAT=${DATE})
if(MCNP5_DATAPATH)
  add_definitions(-DDPATH="${MCNP5_DATAPATH}")
else(MCNP5_DATAPATH)
  if(DEFINED ENV{DATAPATH})
    add_definitions(-DDPATH="$ENV{DATAPATH}")
  else(DEFINED ENV{DATAPATH})
    message(FATAL_ERROR "No MCNP datapath set, please use either the DATAPATH environment variable or set -DMCNP5_DATAPATH to something")  
  endif(DEFINED ENV{DATAPATH})
endif(MCNP5_DATAPATH)


# compiler flags 
add_definitions("-mieee-fp -fdollar-ok -fno-sign-zero")
add_definitions("-m64")

# compiler options
add_definitions(-DTHREAD="MCNP5")
add_definitions(-DTVERS="1.60")

# compiler options
add_definitions(-DGFORTRAN=ON)
add_definitions(-DUNIX=ON)
add_definitions(-DLINUX=ON)
add_definitions(-DF90_REAL_8BYTE=ON)
add_definitions(-DF90_INT_8BYTE=ON)

if(OPENMP_BUILD)
  add_definitions(-DOMP=ON)
endif(OPENMP_BUILD)

if(MCNP5_PLOT) 
  add_definitions(-DXLIB=ON)
  add_definitions(-DPLOT=ON)
  add_definitions(-DMCPLOT=ON)
  add_definitions("-fdefault-integer-8 -fdefault-real-8")
endif(MCNP5_PLOT)

# set_source_files_properties(mc.c PROPERTIES COMPILE_FLAGS -DLINUX)

if(MPI_BUILD)
 add_definitions(-D_DOTCOMM_MPI=ON)
 add_definitions(-DDMMP_NAME="MCNP5")
 add_definitions(-DDOTCOMM_INTERNAL="mpi")
endif(MPI_BUILD)

# Build the Executable
if(MPI_BUILD)
  SET(mcnp_exec "mcnp5.mpi")
else(MPI_BUILD)
  SET(mcnp_exec "mcnp5")
endif(MPI_BUILD)

# if we want a static executable
if(STATIC_LIB)
  set(CMAKE_FIND_LIBRARY_SUFFIXES ".a")
  set(BUILD_SHARED_LIBRARIES OFF)
  set(CMAKE_EXE_LINKER_FLAGS "-static")
  set(STATIC_LIB)
endif(STATIC_LIB)

#add_library(x11 SHARED IMPORTED)
#set_property(TARGET x11 PROPERTY IMPORTED_LOCATION /usr/lib/x86_64-linux-gnu/libX11.so)

# standard macros
if(MPI_BUILD)
  add_definitions(-DKODE="mcnp5.mpi")
  add_definitions(-DMPI=ON)
else(MPI_BUILD)
  add_definitions(-DKODE="mcnp5")
endif(MPI_BUILD)

add_executable(${mcnp_exec} ${MCNP_SRC_FILES} ${MCNP_SRC}/Source/src/main.F90 ${MCNP_SRC}/Source/src/mc.c)

target_link_libraries(${mcnp_exec} 
 			dagmciface 
			dagtally 
			${DAG_LINK_LIBS}
			${HDF5_hdf5_hl_LIBRARY} ${HDF5_hdf5_LIBRARY}
			pyne_dagmc )

if(MCNP5_PLOT)
  target_link_libraries(${mcnp_exec} X11)
endif(MCNP5_PLOT)

if(MPI_BUILD)
  target_link_libraries(${mcnp_exec} ${MPI_LIBRARIES}) 
endif(MPI_BUILD)

INSTALL( TARGETS ${mcnp_exec}
  RUNTIME DESTINATION ${INSTALL_BIN_DIR} )
