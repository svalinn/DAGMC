message(STATUS "Building dagtally unit tests")

set(LINK_LIBS_SHARED gtest dagtally)
set(LINK_LIBS_STATIC gtest dagtally-static)

if (BUILD_STATIC_EXE)
  set(LINK_LIBS_EXE ${LINK_LIBS_STATIC})
else ()
  set(LINK_LIBS_EXE ${LINK_LIBS_SHARED})
endif ()

include_directories(${GTEST_INCLUDE_DIR})

set(DRIVER tally_unit_test_driver.cc)
dagmc_setup_test(test_KDEKernel            cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_KDEMeshTally         cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_KDENeighborhood      cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_PolynomialKernel     cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_Quadrature           cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_CellTally            cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_TallyEvent           cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_TallyData            cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_Tally                cpp ${DRIVER} "${LINK_LIBS_EXE}")
dagmc_setup_test(test_TrackLengthMeshTally cpp ${DRIVER} "${LINK_LIBS_EXE}")

install(FILES hashtag_mesh.h5m      DESTINATION tests)
install(FILES rune_mesh.h5m         DESTINATION tests)
install(FILES structured_mesh.h5m   DESTINATION tests)
install(FILES unstr_mesh_split.h5m  DESTINATION tests)
install(FILES unstructured_mesh.h5m DESTINATION tests)
